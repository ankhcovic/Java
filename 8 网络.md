# 前置知识

## [1. 计算机网络概述](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_1-计算机网络概述)

### [1.1. 基本术语](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_11-基本术语)

1. **结点 （node）** ：网络中的结点可以是计算机，集线器，交换机或路由器等。
2. **链路（link ）** : 从一个结点到另一个结点的一段物理线路。中间没有任何其他交点。
3. **主机（host）** ：连接在因特网上的计算机。
4. **ISP（Internet Service Provider）** ：因特网服务提供者（提供商）。

![ISP (Internet Service Provider) Definition](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\b83f6951e3f8f4bcde5b227257d603a8.png)

1. **IXP（Internet eXchange Point）** ： 互联网交换点 IXP 的主要作用就是允许两个网络直接相连并交换分组，而不需要再通过第三个网络来转发分组。

![IXP Traffic Levels During the Stratos Skydive — RIPE Labs](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\7a9568a9e94001fc110801addc8c4ec0.png)

https://labs.ripe.net/Members/fergalc/ixp-traffic-during-stratos-skydive

1. **RFC(Request For Comments)** ：意思是“请求评议”，包含了关于 Internet 几乎所有的重要的文字资料。
2. **广域网 WAN（Wide Area Network）** ：任务是通过长距离运送主机发送的数据。
3. **城域网 MAN（Metropolitan Area Network）**：用来将多个局域网进行互连。
4. **局域网 LAN（Local Area Network）** ： 学校或企业大多拥有多个互连的局域网。

![MAN & WMAN | Red de área metropolitana, Redes informaticas, Par trenzado](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\25a5789f8e18995c649f2f864d51e7a9.png)

http://conexionesmanwman.blogspot.com/

1. **个人区域网 PAN（Personal Area Network）** ：在个人工作的地方把属于个人使用的电子设备用无线技术连接起来的网络 。

![Advantages and disadvantages of personal area network (PAN) - IT Release](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\5c99dd6011439b1fab6cd2fece155dd5.png)

https://www.itrelease.com/2018/07/advantages-and-disadvantages-of-personal-area-network-pan/

1. **分组（packet ）** ：因特网中传送的数据单元。由首部 header 和数据段组成。分组又称为包，首部可称为包头。
2. **存储转发（store and forward ）** ：路由器收到一个分组，先检查分组是否正确，并过滤掉冲突包错误。确定包正确后，取出目的地址，通过查找表找到想要发送的输出端口地址，然后将该包发送出去。

![img](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\20201025142342169.gif)

1. **带宽（bandwidth）** ：在计算机网络中，表示在单位时间内从网络中的某一点到另一点所能通过的“最高数据率”。常用来表示网络的通信线路所能传送数据的能力。单位是“比特每秒”，记为 b/s。
2. **吞吐量（throughput ）** ：表示在单位时间内通过某个网络（或信道、接口）的数据量。吞吐量更经常地用于对现实世界中的网络的一种测量，以便知道实际上到底有多少数据量能够通过网络。吞吐量受网络的带宽或网络的额定速率的限制。

### [1.2. 重要知识点总结](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_12-重要知识点总结)

1. **计算机网络（简称网络）把许多计算机连接在一起，而互联网把许多网络连接在一起，是网络的网络。**
2. 小写字母 i 开头的 internet（互联网）是通用名词，它泛指由多个计算机网络相互连接而成的网络。在这些网络之间的通信协议（即通信规则）可以是任意的。大写字母 I 开头的 Internet（互联网）是专用名词，它指全球最大的，开放的，由众多网络相互连接而成的特定的互联网，并采用 TCP/IP 协议作为通信规则，其前身为 ARPANET。Internet 的推荐译名为因特网，现在一般流行称为互联网。
3. 路由器是实现分组交换的关键构件，其任务是转发收到的分组，这是网络核心部分最重要的功能。分组交换采用存储转发技术，表示把一个报文（要发送的整块数据）分为几个分组后再进行传送。在发送报文之前，先把较长的报文划分成为一个个更小的等长数据段。在每个数据端的前面加上一些由必要的控制信息组成的首部后，就构成了一个分组。分组又称为包。分组是在互联网中传送的数据单元，正是由于分组的头部包含了诸如目的地址和源地址等重要控制信息，每一个分组才能在互联网中独立的选择传输路径，并正确地交付到分组传输的终点。
4. 互联网按工作方式可划分为边缘部分和核心部分。主机在网络的边缘部分，其作用是进行信息处理。由大量网络和连接这些网络的路由器组成核心部分，其作用是提供连通性和交换。
5. 计算机通信是计算机中进程（即运行着的程序）之间的通信。计算机网络采用的通信方式是客户-服务器方式（C/S 方式）和对等连接方式（P2P 方式）。
6. 客户和服务器都是指通信中所涉及的应用进程。客户是服务请求方，服务器是服务提供方。
7. 按照作用范围的不同，计算机网络分为广域网 WAN，城域网 MAN，局域网 LAN，个人区域网 PAN。
8. **计算机网络最常用的性能指标是：速率，带宽，吞吐量，时延（发送时延，处理时延，排队时延），时延带宽积，往返时间和信道利用率。**
9. 网络协议即协议，是为进行网络中的数据交换而建立的规则。计算机网络的各层以及其协议集合，称为网络的体系结构。
10. **五层体系结构由应用层，运输层，网络层（网际层），数据链路层，物理层组成。运输层最主要的协议是 TCP 和 UDP 协议，网络层最重要的协议是 IP 协议。**

![s](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\2020102514243717.png)

下面的内容会介绍计算机网络的五层体系结构：**物理层+数据链路层+网络层（网际层）+运输层+应用层**。

## [2. 物理层（Physical Layer）](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_2-物理层（physical-layer）)

![物理层](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\4749289d6e152bab1c8a8ccfc946a797.png)

### [2.1. 基本术语](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_21-基本术语)

1. **数据（data）** :运送消息的实体。
2. **信号（signal）** ：数据的电气的或电磁的表现。或者说信号是适合在传输介质上传输的对象。
3. **码元（ code）** ：在使用时间域（或简称为时域）的波形来表示数字信号时，代表不同离散数值的基本波形。
4. **单工（simplex ）** : 只能有一个方向的通信而没有反方向的交互。
5. **半双工（half duplex ）** ：通信的双方都可以发送信息，但不能双方同时发送(当然也就不能同时接收)。
6. **全双工（full duplex）** : 通信的双方可以同时发送和接收信息。

![img](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\c5be4756d2d6f46cbb6d785d5b86faf1.png)

1. **失真**：失去真实性，主要是指接受到的信号和发送的信号不同，有磨损和衰减。影响失真程度的因素：1.码元传输速率 2.信号传输距离 3.噪声干扰 4.传输媒体质量

![img](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\aef3aac72e86c1ee6ccb8a91647f656c.png)

1. **奈氏准则** : 在任何信道中，码元的传输的效率是有上限的，传输速率超过此上限，就会出现严重的码间串扰问题，使接收端对码元的判决（即识别）成为不可能。
2. **香农定理** ：在带宽受限且有噪声的信道中，为了不产生误差，信息的数据传输速率有上限值。
3. **基带信号（baseband signal）** : 来自信源的信号。指没有经过调制的数字信号或模拟信号。
4. **带通（频带）信号（bandpass signal）** ：把基带信号经过载波调制后，把信号的频率范围搬移到较高的频段以便在信道中传输（即仅在一段频率范围内能够通过信道），这里调制过后的信号就是带通信号。
5. **调制（modulation ）** : 对信号源的信息进行处理后加到载波信号上，使其变为适合在信道传输的形式的过程。
6. **信噪比（signal-to-noise ratio ）** : 指信号的平均功率和噪声的平均功率之比，记为 S/N。信噪比（dB）=10*log10（S/N）。
7. **信道复用（channel multiplexing ）** ：指多个用户共享同一个信道。（并不一定是同时）。

![信道复用技术](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\a4889adaad3314f882e2cfab5f382064.png)

1. **比特率（bit rate ）** ：单位时间（每秒）内传送的比特数。
2. **波特率（baud rate）** ：单位时间载波调制状态改变的次数。针对数据信号对载波的调制速率。
3. **复用（multiplexing）** ：共享信道的方法。
4. **ADSL（Asymmetric Digital Subscriber Line ）** ：非对称数字用户线。
5. **光纤同轴混合网（HFC 网）** :在目前覆盖范围很广的有线电视网的基础上开发的一种居民宽带接入网

### [2.2. 重要知识点总结](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_22-重要知识点总结)

1. **物理层的主要任务就是确定与传输媒体接口有关的一些特性，如机械特性，电气特性，功能特性，过程特性。**
2. 一个数据通信系统可划分为三大部分，即源系统，传输系统，目的系统。源系统包括源点（或源站，信源）和发送器，目的系统包括接收器和终点。
3. **通信的目的是传送消息。如话音，文字，图像等都是消息，数据是运送消息的实体。信号则是数据的电器或电磁的表现。**
4. 根据信号中代表消息的参数的取值方式不同，信号可分为模拟信号（或连续信号）和数字信号（或离散信号）。在使用时间域（简称时域）的波形表示数字信号时，代表不同离散数值的基本波形称为码元。
5. 根据双方信息交互的方式，通信可划分为单向通信（或单工通信），双向交替通信（或半双工通信），双向同时通信（全双工通信）。
6. 来自信源的信号称为基带信号。信号要在信道上传输就要经过调制。调制有基带调制和带通调制之分。最基本的带通调制方法有调幅，调频和调相。还有更复杂的调制方法，如正交振幅调制。
7. 要提高数据在信道上的传递速率，可以使用更好的传输媒体，或使用先进的调制技术。但数据传输速率不可能任意被提高。
8. 传输媒体可分为两大类，即导引型传输媒体（双绞线，同轴电缆，光纤）和非导引型传输媒体（无线，红外，大气激光）。
9. 了有效利用光纤资源，在光纤干线和用户之间广泛使用无源光网络 PON。无源光网络无需配备电源，其长期运营成本和管理成本都很低。最流行的无源光网络是以太网无源光网络 EPON 和吉比特无源光网络 GPON。

### [2.3. 补充](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_23-补充)

#### [2.3.1. 物理层主要做啥？](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_231-物理层主要做啥？)

物理层主要做的事情就是 **透明地传送比特流**。也可以将物理层的主要任务描述为确定与传输媒体的接口的一些特性，即：机械特性（接口所用接线器的一些物理属性如形状尺寸），电气特性（接口电缆的各条线上出现的电压的范围），功能特性（某条线上出现的某一电平的电压的意义），过程特性（对于不同功能能的各种可能事件的出现顺序）。

**物理层考虑的是怎样才能在连接各种计算机的传输媒体上传输数据比特流，而不是指具体的传输媒体。** 现有的计算机网络中的硬件设备和传输媒体的种类非常繁多，而且通信手段也有许多不同的方式。物理层的作用正是尽可能地屏蔽掉这些传输媒体和通信手段的差异，使物理层上面的数据链路层感觉不到这些差异，这样就可以使数据链路层只考虑完成本层的协议和服务，而不必考虑网络的具体传输媒体和通信手段是什么。

#### [2.3.2. 几种常用的信道复用技术](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_232-几种常用的信道复用技术)

1. **频分复用(FDM)** ：所有用户在同样的时间占用不同的带宽资源。
2. **时分复用（TDM）** ：所有用户在不同的时间占用同样的频带宽度（分时不分频）。
3. **统计时分复用 (Statistic TDM)** ：改进的时分复用，能够明显提高信道的利用率。
4. **码分复用(CDM)** ： 用户使用经过特殊挑选的不同码型，因此各用户之间不会造成干扰。这种系统发送的信号有很强的抗干扰能力，其频谱类似于白噪声，不易被敌人发现。
5. **波分复用( WDM)** ：波分复用就是光的频分复用。

#### [2.3.3. 几种常用的宽带接入技术，主要是 ADSL 和 FTTx](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_233-几种常用的宽带接入技术，主要是-adsl-和-fttx)

用户到互联网的宽带接入方法有非对称数字用户线 ADSL（用数字技术对现有的模拟电话线进行改造，而不需要重新布线。ASDL 的快速版本是甚高速数字用户线 VDSL。），光纤同轴混合网 HFC（是在目前覆盖范围很广的有线电视网的基础上开发的一种居民宽带接入网）和 FTTx（即光纤到······）。

## [3. 数据链路层（Data Link Layer）](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_3-数据链路层（data-link-layer）)

![数据链路层](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\8d24d1684552fa9cc824ce72b3087637.png)

### [3.1. 基本术语](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_31-基本术语)

1. **链路（link）** ：一个结点到相邻结点的一段**物理链路**。
2. **数据链路（data link）** ：**链路 + 通讯协议** 把**实现控制数据运输的协议的硬件和软件加到链路上**就构成了数据链路。
3. **循环冗余检验 CRC（Cyclic Redundancy Check）** ：为了保证数据传输的可靠性，CRC 是数据链路层广泛使用的一种检错技术。
4. **帧（frame）** ：一个数据链路层的传输单元，由一个数据链路层首部和其携带的封包所组成协议数据单元。
5. **MTU（Maximum Transfer Uint ）** ：最大传送单元。帧的数据部分的的长度上限。
6. **误码率 BER（Bit Error Rate ）** ：在一段时间内，传输错误的比特占所传输比特总数的比率。
7. **PPP（Point-to-Point Protocol ）** ：点对点协议。即用户计算机和 ISP 进行通信时所使用的数据链路层协议。以下是 PPP 帧的示意图： ![PPP](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\298dbdeb16f98cec02c3954d8d95c1d6.png)
8. **MAC 地址（Media Access Control 或者 Medium Access Control）** ：意译为媒体访问控制，或称为物理地址、硬件地址，用来定义网络设备的位置。在 OSI 模型中，第三层网络层负责 IP 地址，第二层数据链路层则负责 MAC 地址。因此一个主机会有一个 MAC 地址，而每个网络位置会有一个专属于它的 IP 地址 。地址是识别某个系统的重要标识符，“名字指出我们所要寻找的资源，地址指出资源所在的地方，路由告诉我们如何到达该处。

![ARP (Address Resolution Protocol) explained](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\002b2e6e45d66e805008fafc310afef0.png)

1. **网桥（bridge）** ：一种用于数据链路层实现中继，连接两个或多个局域网的网络互连设备。
2. **交换机（switch ）** ：广义的来说，交换机指的是一种通信系统中完成信息交换的设备。这里工作在数据链路层的交换机指的是交换式集线器，其实质是一个多接口的网桥

### [3.2. 重要知识点总结](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_32-重要知识点总结)

1. 链路是从一个结点到相邻节点的一段物理链路，数据链路则在链路的基础上增加了一些必要的硬件（如网络适配器）和软件（如协议的实现）
2. 数据链路层使用的主要是**点对点信道**和**广播信道**两种。
3. 数据链路层传输的协议数据单元是帧。数据链路层的三个基本问题是：**封装成帧**，**透明传输**和**差错检测**
4. **循环冗余检验 CRC** 是一种检错方法，而帧检验序列 FCS 是添加在数据后面的冗余码
5. **点对点协议 PPP** 是数据链路层使用最多的一种协议，它的特点是：简单，只检测差错而不去纠正差错，不使用序号，也不进行流量控制，可同时支持多种网络层协议
6. PPPoE 是为宽带上网的主机使用的链路层协议
7. **局域网的优点是：具有广播功能，从一个站点可方便地访问全网；便于系统的扩展和逐渐演变；提高了系统的可靠性，可用性和生存性。**
8. 计算机与外接局域网通信需要通过通信适配器（或网络适配器），它又称为网络接口卡或网卡。**计算器的硬件地址就在适配器的 ROM 中**。
9. 以太网采用的无连接的工作方式，对发送的数据帧不进行编号，也不要求对方发回确认。目的站收到有差错帧就把它丢掉，其他什么也不做
10. 以太网采用的协议是具有冲突检测的**载波监听多点接入 CSMA/CD**。协议的特点是：**发送前先监听，边发送边监听，一旦发现总线上出现了碰撞，就立即停止发送。然后按照退避算法等待一段随机时间后再次发送。** 因此，每一个站点在自己发送数据之后的一小段时间内，存在这遭遇碰撞的可能性。以太网上的各站点平等的争用以太网信道
11. 以太网的适配器具有过滤功能，它只接收单播帧，广播帧和多播帧。
12. 使用集线器可以在物理层扩展以太网（扩展后的以太网仍然是一个网络）

### [3.3. 补充](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_33-补充)

1. 数据链路层的点对点信道和广播信道的特点，以及这两种信道所使用的协议（PPP 协议以及 CSMA/CD 协议）的特点

   

2. 数据链路层的三个基本问题：**封装成帧**，**透明传输**，**差错检测**

   **封装成帧**：在一段数据的前后分别添加首部和尾部。
   分组交换的一个重要概念：所有在因特网上传送的数据都是以**分组（即IP数据报）为传送单位**。网络层的IP数据报传送到数据链路层就成为帧的数据部分。在帧的数据部分的前面和后面分别添加上首部和尾部，构成了一个完整的帧。这样的帧就是数据链路层的数据传送单元。

   **透明传输：**

   首先要明确这样一个概念：由于帧的开始和结束的标记是使用专门指明的控制字符，因此，所传输的数据中的任何8比特的组合一定不允许和用作帧定界的控制字符的编码一样，否则就会出现帧定界错误。

   而”透明传输“的意思是：无论什么样的比特组合的数据都可以进行传输。

   为了解决**透明传输**的问题，就必须设法使数据中可能出现的控制字符”SOH“和”EOT“在接收端不被解释为控制字符。具体的**方法**是：发送端的数据链路层在数据中出现控制字符的前面加上一个转义字符。而在接收端的数据链路层在把数据送往网络层之前删除这个插入的转义字符。如果转义字符也出现在数据当中，那么解决方法仍然是在转义字符的前面插入一个转移字符。因此，当接收端收到连续的两个转义字符时，就删除其中前面一个。

   **差错检测：**

   比特在传输过程中可能会产生差错：1可能变成0，0可能变成1。
   目前在数据链路层广泛使用了**循环冗余检验CRC**的检错技术。
   **为了检错而添加的冗余码常被称为帧检验序列FCS**。
   在数据链路层，发送端帧检验序列FCS的生成和接收端CRC检验都是用硬件完成的，处理很迅速，因此不会延误数据的传输。

3. 以太网的 MAC 层硬件地址

   **计算器的硬件地址就在适配器的 ROM 中**

4. 适配器，转发器，集线器，网桥，以太网交换机的作用以及适用场合

## [4. 网络层（Network Layer）](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_4-网络层（network-layer）)

![网络层](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\fbf78bdcf3db11526ac1a234a8b98234.png)

### [4.1. 基本术语](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_41-基本术语)

1. **虚电路（Virtual Circuit）** : 在两个终端设备的逻辑或物理端口之间，通过建立的双向的透明传输通道。虚电路表示这只是一条逻辑上的连接，分组都沿着这条逻辑连接按照存储转发方式传送，而并不是真正建立了一条物理连接。
2. **IP（Internet Protocol ）** : 网际协议 IP 是 TCP/IP 体系中两个最主要的协议之一，是 TCP/IP 体系结构网际层的核心。配套的有 ARP，RARP，ICMP，IGMP。
3. **ARP（Address Resolution Protocol）** : 地址解析协议。地址解析协议 ARP 把 IP 地址解析为硬件地址。
4. **ICMP（Internet Control Message Protocol ）** ：网际控制报文协议 （ICMP 允许主机或路由器报告差错情况和提供有关异常情况的报告）。
5. **子网掩码（subnet mask ）** ：它是一种用来指明一个 IP 地址的哪些位标识的是主机所在的子网以及哪些位标识的是主机的位掩码。子网掩码不能单独存在，它必须结合 IP 地址一起使用。
6. **CIDR（ Classless Inter-Domain Routing ）**：无分类域间路由选择 （特点是消除了传统的 A 类、B 类和 C 类地址以及划分子网的概念，并使用各种长度的“网络前缀”(network-prefix)来代替分类地址中的网络号和子网号）。
7. **默认路由（default route）** ：当在路由表中查不到能到达目的地址的路由时，路由器选择的路由。默认路由还可以减小路由表所占用的空间和搜索路由表所用的时间。
8. **路由选择算法（Virtual Circuit）** ：路由选择协议的核心部分。因特网采用自适应的，分层次的路由选择协议。

### [4.2. 重要知识点总结](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_42-重要知识点总结)

1. **TCP/IP 协议中的网络层向上只提供简单灵活的，无连接的，尽最大努力交付的数据报服务。网络层不提供服务质量的承诺，不保证分组交付的时限所传送的分组可能出错，丢失，重复和失序。进程之间通信的可靠性由运输层负责**
2. 在互联网的交付有两种，一是在本网络直接交付不用经过路由器，另一种是和其他网络的间接交付，至少经过一个路由器，但最后一次一定是直接交付
3. 分类的 IP 地址由网络号字段（指明网络）和主机号字段（指明主机）组成。网络号字段最前面的类别指明 IP 地址的类别。IP 地址是一种分等级的地址结构。IP 地址管理机构分配 IP 地址时只分配网络号，主机号由得到该网络号的单位自行分配。路由器根据目的主机所连接的网络号来转发分组。一个路由器至少连接到两个网络，所以一个路由器至少应当有两个不同的 IP 地址
4. IP 数据报分为首部和数据两部分。首部的前一部分是固定长度，共 20 字节，是所有 IP 数据包必须具有的（源地址，目的地址，总长度等重要地段都固定在首部）。一些长度可变的可选字段固定在首部的后面。IP 首部中的生存时间给出了 IP 数据报在互联网中所能经过的最大路由器数。可防止 IP 数据报在互联网中无限制的兜圈子。
5. **地址解析协议 ARP 把 IP 地址解析为硬件地址。ARP 的高速缓存可以大大减少网络上的通信量。因为这样可以使主机下次再与同样地址的主机通信时，可以直接从高速缓存中找到所需要的硬件地址而不需要再去广播方式发送 ARP 请求分组**
6. 无分类域间路由选择 CIDR 是解决目前 IP 地址紧缺的一个好办法。CIDR 记法把 IP 地址后面加上斜线“/”，然后写上前缀所所占的位数。前缀（或网络前缀用来指明网络），前缀后面的部分是后缀，用来指明主机。CIDR 把前缀都相同的连续的 IP 地址组成一个“CIDR 地址块”，IP 地址分配都以 CIDR 地址块为单位。
7. 网际控制报文协议是 IP 层的协议。ICMP 报文作为 IP 数据报的数据，加上首部后组成 IP 数据报发送出去。使用 ICMP 数据报并不是为了实现可靠传输。ICMP 允许主机或路由器报告差错情况和提供有关异常情况的报告。ICMP 报文的种类有两种 ICMP 差错报告报文和 ICMP 询问报文。
8. **要解决 IP 地址耗尽的问题，最根本的办法是采用具有更大地址空间的新版本 IP 协议-IPv6。** IPv6 所带来的变化有 ① 更大的地址空间（采用 128 位地址）② 灵活的首部格式 ③ 改进的选项 ④ 支持即插即用 ⑤ 支持资源的预分配 ⑥IPv6 的首部改为 8 字节对齐。
9. **虚拟专用网络 VPN 利用公用的互联网作为本机构专用网之间的通信载体。VPN 内使用互联网的专用地址。一个 VPN 至少要有一个路由器具有合法的全球 IP 地址，这样才能和本系统的另一个 VPN 通过互联网进行通信。所有通过互联网传送的数据都需要加密。**
10. MPLS 的特点是：① 支持面向连接的服务质量 ② 支持流量工程，平衡网络负载 ③ 有效的支持虚拟专用网 VPN。MPLS 在入口节点给每一个 IP 数据报打上固定长度的“标记”，然后根据标记在第二层（链路层）用硬件进行转发（在标记交换路由器中进行标记交换），因而转发速率大大加快。

## [5. 传输层（Transport Layer）](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_5-传输层（transport-layer）)

![传输层](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\09eb87a29bed99775ef5bde5eb216971.png)

### [5.1. 基本术语](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_51-基本术语)

1. **进程（process）** ：指计算机中正在运行的程序实体。
2. **应用进程互相通信** ：一台主机的进程和另一台主机中的一个进程交换数据的过程（另外注意通信真正的端点不是主机而是主机中的进程，也就是说端到端的通信是应用进程之间的通信）。
3. **传输层的复用与分用** ：复用指发送方不同的进程都可以通过统一个运输层协议传送数据。分用指接收方的运输层在剥去报文的首部后能把这些数据正确的交付到目的应用进程。
4. **TCP（Transmission Control Protocol）** ：传输控制协议。
5. **UDP（User Datagram Protocol）** ：用户数据报协议。

![TCP和UDP](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\2bd5bf90676c338864807ade87b7bdea.png)

1. **端口（port）** ：端口的目的是为了确认对方机器是那个进程在于自己进行交互，比如 MSN 和 QQ 的端口不同，如果没有端口就可能出现 QQ 进程和 MSN 交互错误。端口又称协议端口号。
2. **停止等待协议（stop-and-wait）** ：指发送方每发送完一个分组就停止发送，等待对方确认，在收到确认之后在发送下一个分组。
3. **流量控制** : 就是让发送方的发送速率不要太快，既要让接收方来得及接收，也不要使网络发生拥塞。
4. **拥塞控制** ：防止过多的数据注入到网络中，这样可以使网络中的路由器或链路不致过载。拥塞控制所要做的都有一个前提，就是网络能够承受现有的网络负荷。

### [5.2. 重要知识点总结](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_52-重要知识点总结)

1. **运输层提供应用进程之间的逻辑通信，也就是说，运输层之间的通信并不是真正在两个运输层之间直接传输数据。运输层向应用层屏蔽了下面网络的细节（如网络拓补，所采用的路由选择协议等），它使应用进程之间看起来好像两个运输层实体之间有一条端到端的逻辑通信信道。**
2. **网络层为主机提供逻辑通信，而运输层为应用进程之间提供端到端的逻辑通信。**
3. 运输层的两个重要协议是用户数据报协议 UDP 和传输控制协议 TCP。按照 OSI 的术语，两个对等运输实体在通信时传送的数据单位叫做运输协议数据单元 TPDU（Transport Protocol Data Unit）。但在 TCP/IP 体系中，则根据所使用的协议是 TCP 或 UDP，分别称之为 TCP 报文段或 UDP 用户数据报。
4. **UDP 在传送数据之前不需要先建立连接，远地主机在收到 UDP 报文后，不需要给出任何确认。虽然 UDP 不提供可靠交付，但在某些情况下 UDP 确是一种最有效的工作方式。 TCP 提供面向连接的服务。在传送数据之前必须先建立连接，数据传送结束后要释放连接。TCP 不提供广播或多播服务。由于 TCP 要提供可靠的，面向连接的传输服务，这一难以避免增加了许多开销，如确认，流量控制，计时器以及连接管理等。这不仅使协议数据单元的首部增大很多，还要占用许多处理机资源。**
5. 硬件端口是不同硬件设备进行交互的接口，而软件端口是应用层各种协议进程与运输实体进行层间交互的一种地址。UDP 和 TCP 的首部格式中都有源端口和目的端口这两个重要字段。当运输层收到 IP 层交上来的运输层报文时，就能够 根据其首部中的目的端口号把数据交付应用层的目的应用层。（两个进程之间进行通信不光要知道对方 IP 地址而且要知道对方的端口号(为了找到对方计算机中的应用进程)）
6. 运输层用一个 16 位端口号标志一个端口。端口号只有本地意义，它只是为了标志计算机应用层中的各个进程在和运输层交互时的层间接口。在互联网的不同计算机中，相同的端口号是没有关联的。协议端口号简称端口。虽然通信的终点是应用进程，但只要把所发送的报文交到目的主机的某个合适端口，剩下的工作（最后交付目的进程）就由 TCP 和 UDP 来完成。
7. 运输层的端口号分为服务器端使用的端口号（0~~1023 指派给熟知端口，1024~~49151 是登记端口号）和客户端暂时使用的端口号（49152~65535）
8. **UDP 的主要特点是 ① 无连接 ② 尽最大努力交付 ③ 面向报文 ④ 无拥塞控制 ⑤ 支持一对一，一对多，多对一和多对多的交互通信 ⑥ 首部开销小（只有四个字段：源端口，目的端口，长度和检验和）**
9. **TCP 的主要特点是 ① 面向连接 ② 每一条 TCP 连接只能是一对一的 ③ 提供可靠交付 ④ 提供全双工通信 ⑤ 面向字节流**
10. **TCP 用主机的 IP 地址加上主机上的端口号作为 TCP 连接的端点。这样的端点就叫做套接字（socket）或插口。套接字用（IP 地址：端口号）来表示。每一条 TCP 连接唯一被通信两端的两个端点所确定。**
11. 停止等待协议是为了实现可靠传输的，它的基本原理就是每发完一个分组就停止发送，等待对方确认。在收到确认后再发下一个分组。
12. 为了提高传输效率，发送方可以不使用低效率的停止等待协议，而是采用流水线传输。流水线传输就是发送方可连续发送多个分组，不必每发完一个分组就停下来等待对方确认。这样可使信道上一直有数据不间断的在传送。这种传输方式可以明显提高信道利用率。
13. 停止等待协议中超时重传是指只要超过一段时间仍然没有收到确认，就重传前面发送过的分组（认为刚才发送过的分组丢失了）。因此每发送完一个分组需要设置一个超时计时器，其重转时间应比数据在分组传输的平均往返时间更长一些。这种自动重传方式常称为自动重传请求 ARQ。另外在停止等待协议中若收到重复分组，就丢弃该分组，但同时还要发送确认。连续 ARQ 协议可提高信道利用率。发送维持一个发送窗口，凡位于发送窗口内的分组可连续发送出去，而不需要等待对方确认。接收方一般采用累积确认，对按序到达的最后一个分组发送确认，表明到这个分组位置的所有分组都已经正确收到了。
14. TCP 报文段的前 20 个字节是固定的，后面有 4n 字节是根据需要增加的选项。因此，TCP 首部的最小长度是 20 字节。
15. **TCP 使用滑动窗口机制。发送窗口里面的序号表示允许发送的序号。发送窗口后沿的后面部分表示已发送且已收到确认，而发送窗口前沿的前面部分表示不允许发送。发送窗口后沿的变化情况有两种可能，即不动（没有收到新的确认）和前移（收到了新的确认）。发送窗口的前沿通常是不断向前移动的。一般来说，我们总是希望数据传输更快一些。但如果发送方把数据发送的过快，接收方就可能来不及接收，这就会造成数据的丢失。所谓流量控制就是让发送方的发送速率不要太快，要让接收方来得及接收。**
16. 在某段时间，若对网络中某一资源的需求超过了该资源所能提供的可用部分，网络的性能就要变坏。这种情况就叫拥塞。拥塞控制就是为了防止过多的数据注入到网络中，这样就可以使网络中的路由器或链路不致过载。拥塞控制所要做的都有一个前提，就是网络能够承受现有的网络负荷。拥塞控制是一个全局性的过程，涉及到所有的主机，所有的路由器，以及与降低网络传输性能有关的所有因素。相反，流量控制往往是点对点通信量的控制，是个端到端的问题。流量控制所要做到的就是抑制发送端发送数据的速率，以便使接收端来得及接收。
17. **为了进行拥塞控制，TCP 发送方要维持一个拥塞窗口 cwnd 的状态变量。拥塞控制窗口的大小取决于网络的拥塞程度，并且动态变化。发送方让自己的发送窗口取为拥塞窗口和接收方的接受窗口中较小的一个。**
18. **TCP 的拥塞控制采用了四种算法，即慢开始，拥塞避免，快重传和快恢复。在网络层也可以使路由器采用适当的分组丢弃策略（如主动队列管理 AQM），以减少网络拥塞的发生。**
19. 运输连接的三个阶段，即：连接建立，数据传送和连接释放。
20. **主动发起 TCP 连接建立的应用进程叫做客户，而被动等待连接建立的应用进程叫做服务器。TCP 连接采用三报文握手机制。服务器要确认用户的连接请求，然后客户要对服务器的确认进行确认。**
21. TCP 的连接释放采用四报文握手机制。任何一方都可以在数据传送结束后发出连接释放的通知，待对方确认后进入半关闭状态。当另一方也没有数据再发送时，则发送连接释放通知，对方确认后就完全关闭了 TCP 连接

### [5.3. 补充（重要）](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_53-补充（重要）)

以下知识点需要重点关注：

1. 端口和套接字的意义
2. UDP 和 TCP 的区别以及两者的应用场景
3. 在不可靠的网络上实现可靠传输的工作原理，停止等待协议和 ARQ 协议
4. TCP 的滑动窗口，流量控制，拥塞控制和连接管理
5. TCP 的三次握手，四次挥手机制

## [6. 应用层（Application Layer）](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_6-应用层（application-layer）)

![应用层](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\3ff57c0632bc7f4017723b1d1b7d3a52.png)

### [6.1. 基本术语](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_61-基本术语)

1. **域名系统（DNS）** ：域名系统（DNS，Domain Name System）将人类可读的域名 (例如，[www.baidu.com](http://www.baidu.com/)) 转换为机器可读的 IP 地址 (例如，220.181.38.148)。我们可以将其理解为专为互联网设计的电话薄。

![img](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\6af26a3293530061785df50e70d53e07.png)

https://www.seobility.net/en/wiki/HTTP_headers

1. **文件传输协议（FTP）** ：FTP 是 File TransferProtocol（文件传输协议）的英文简称，而中文简称为“文传协议”。用于 Internet 上的控制文件的双向传输。同时，它也是一个应用程序（Application）。基于不同的操作系统有不同的 FTP 应用程序，而所有这些应用程序都遵守同一种协议以传输文件。在 FTP 的使用当中，用户经常遇到两个概念："下载"（Download）和"上传"（Upload）。 "下载"文件就是从远程主机拷贝文件至自己的计算机上；"上传"文件就是将文件从自己的计算机中拷贝至远程主机上。用 Internet 语言来说，用户可通过客户机程序向（从）远程主机上传（下载）文件。

![FTP工作过程](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\3f1abf8adba4aa317eca69c489e3db23.png)

1. **简单文件传输协议（TFTP）** ：TFTP（Trivial File Transfer Protocol,简单文件传输协议）是 TCP/IP 协议族中的一个用来在客户机与服务器之间进行简单文件传输的协议，提供不复杂、开销不大的文件传输服务。端口号为 69。
2. **远程终端协议（TELNET）** ：Telnet 协议是 TCP/IP 协议族中的一员，是 Internet 远程登陆服务的标准协议和主要方式。它为用户提供了在本地计算机上完成远程主机工作的能力。在终端使用者的电脑上使用 telnet 程序，用它连接到服务器。终端使用者可以在 telnet 程序中输入命令，这些命令会在服务器上运行，就像直接在服务器的控制台上输入一样。可以在本地就能控制服务器。要开始一个 telnet 会话，必须输入用户名和密码来登录服务器。Telnet 是常用的远程控制 Web 服务器的方法。
3. **万维网（WWW）** ：WWW 是环球信息网的缩写，（亦作“Web”、“WWW”、“'W3'”，英文全称为“World Wide Web”），中文名字为“万维网”，"环球网"等，常简称为 Web。分为 Web 客户端和 Web 服务器程序。WWW 可以让 Web 客户端（常用浏览器）访问浏览 Web 服务器上的页面。是一个由许多互相链接的超文本组成的系统，通过互联网访问。在这个系统中，每个有用的事物，称为一样“资源”；并且由一个全局“统一资源标识符”（URI）标识；这些资源通过超文本传输协议（Hypertext Transfer Protocol）传送给用户，而后者通过点击链接来获得资源。万维网联盟（英语：World Wide Web Consortium，简称 W3C），又称 W3C 理事会。1994 年 10 月在麻省理工学院（MIT）计算机科学实验室成立。万维网联盟的创建者是万维网的发明者蒂姆·伯纳斯-李。万维网并不等同互联网，万维网只是互联网所能提供的服务其中之一，是靠着互联网运行的一项服务。
4. **万维网的大致工作工程：**

![万维网的大致工作工程](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\735f55501e81898aa61b8032f7dbcb73.png)

1. **统一资源定位符（URL）** ：统一资源定位符是对可以从互联网上得到的资源的位置和访问方法的一种简洁的表示，是互联网上标准资源的地址。互联网上的每个文件都有一个唯一的 URL，它包含的信息指出文件的位置以及浏览器应该怎么处理它。
2. **超文本传输协议（HTTP）** ：超文本传输协议（HTTP，HyperText Transfer Protocol)是互联网上应用最为广泛的一种网络协议。所有的 WWW 文件都必须遵守这个标准。设计 HTTP 最初的目的是为了提供一种发布和接收 HTML 页面的方法。1960 年美国人 Ted Nelson 构思了一种通过计算机处理文本信息的方法，并称之为超文本（hypertext）,这成为了 HTTP 超文本传输协议标准架构的发展根基。

HTTP 协议的本质就是一种浏览器与服务器之间约定好的通信格式。HTTP 的原理如下图所示：

![img](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\b273efef5f2388e26414135672b00295.png)

1. **代理服务器（Proxy Server）** ： 代理服务器（Proxy Server）是一种网络实体，它又称为万维网高速缓存。 代理服务器把最近的一些请求和响应暂存在本地磁盘中。当新请求到达时，若代理服务器发现这个请求与暂时存放的的请求相同，就返回暂存的响应，而不需要按 URL 的地址再次去互联网访问该资源。代理服务器可在客户端或服务器工作，也可以在中间系统工作。
2. **简单邮件传输协议(SMTP)** : SMTP（Simple Mail Transfer Protocol）即简单邮件传输协议,它是一组用于由源地址到目的地址传送邮件的规则，由它来控制信件的中转方式。 SMTP 协议属于 TCP/IP 协议簇，它帮助每台计算机在发送或中转信件时找到下一个目的地。 通过 SMTP 协议所指定的服务器,就可以把 E-mail 寄到收信人的服务器上了，整个过程只要几分钟。SMTP 服务器则是遵循 SMTP 协议的发送邮件服务器，用来发送或中转发出的电子邮件。

![一个电子邮件被发送的过程](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\b16da4d4fea63de5fce53f54973967d7.png)

https://www.campaignmonitor.com/resources/knowledge-base/what-is-the-code-that-makes-bcc-or-cc-operate-in-an-email/



1. **搜索引擎** :搜索引擎（Search Engine）是指根据一定的策略、运用特定的计算机程序从互联网上搜集信息，在对信息进行组织和处理后，为用户提供检索服务，将用户检索相关的信息展示给用户的系统。搜索引擎包括全文索引、目录索引、元搜索引擎、垂直搜索引擎、集合式搜索引擎、门户搜索引擎与免费链接列表等。

![搜索引擎](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\68fe865a9d87de361c45f4a42d624035.png)

1. **垂直搜索引擎** ：垂直搜索引擎是针对某一个行业的专业搜索引擎，是搜索引擎的细分和延伸，是对网页库中的某类专门的信息进行一次整合，定向分字段抽取出需要的数据进行处理后再以某种形式返回给用户。垂直搜索是相对通用搜索引擎的信息量大、查询不准确、深度不够等提出来的新的搜索引擎服务模式，通过针对某一特定领域、某一特定人群或某一特定需求提供的有一定价值的信息和相关服务。其特点就是“专、精、深”，且具有行业色彩，相比较通用搜索引擎的海量信息无序化，垂直搜索引擎则显得更加专注、具体和深入。
2. **全文索引** :全文索引技术是目前搜索引擎的关键技术。试想在 1M 大小的文件中搜索一个词，可能需要几秒，在 100M 的文件中可能需要几十秒，如果在更大的文件中搜索那么就需要更大的系统开销，这样的开销是不现实的。所以在这样的矛盾下出现了全文索引技术，有时候有人叫倒排文档技术。
3. **目录索引** ：目录索引（ search index/directory)，顾名思义就是将网站分门别类地存放在相应的目录中，因此用户在查询信息时，可选择关键词搜索，也可按分类目录逐层查找。

### [6.2. 重要知识点总结](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_62-重要知识点总结)

1. 文件传输协议（FTP）使用 TCP 可靠的运输服务。FTP 使用客户服务器方式。一个 FTP 服务器进程可以同时为多个用户提供服务。在进进行文件传输时，FTP 的客户和服务器之间要先建立两个并行的 TCP 连接:控制连接和数据连接。实际用于传输文件的是数据连接。
2. 万维网客户程序与服务器之间进行交互使用的协议是超文本传输协议 HTTP。HTTP 使用 TCP 连接进行可靠传输。但 HTTP 本身是无连接、无状态的。HTTP/1.1 协议使用了持续连接（分为非流水线方式和流水线方式）
3. 电子邮件把邮件发送到收件人使用的邮件服务器，并放在其中的收件人邮箱中，收件人可随时上网到自己使用的邮件服务器读取，相当于电子邮箱。
4. 一个电子邮件系统有三个重要组成构件：用户代理、邮件服务器、邮件协议（包括邮件发送协议，如 SMTP，和邮件读取协议，如 POP3 和 IMAP）。用户代理和邮件服务器都要运行这些协议。

### [6.3. 补充（重要）](https://snailclimb.gitee.io/javaguide/#/docs/network/计算机网络知识总结?id=_63-补充（重要）)

以下知识点需要重点关注：

1. 应用层的常见协议（重点关注 HTTP 协议）
2. 域名系统-从域名解析出 IP 地址
3. 访问一个网站大致的过程
4. 系统调用和应用编程接口概念

# 面试经验

从准备找工作到现在刷过的面经应该不少于200篇，对各个领域常出现的问题及其出现的频次都有一定的了解，所以发上来帮助大家准备面试。问题的覆盖面应该足够广，最少能覆盖95%以上的面试题。今天是计网篇，后面会陆陆续续发操作系统、Java语言基础、数据库、Redis、Spring全家桶等部分。 根据问题出现的频次、重要程度、答不上来导致面试挂掉的可能性分为以下几个层级。

## 1. 超高频，答不上来必死

![七层体系结构图](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\七层体系结构图.png)

### 1.1 **OSI七层模型及每层简要功能描述**

**侧重通信协议必要的功能有哪些**

- 应用层：为应用程序提供服务并规定应用程序中通信相关的细节。包括文件传输、电 子邮件、远程登录（虚拟终端）等协议。
- 表示层：将应用处理的信息转换为适合网络传输的格式，或将来自下一层的数据转换 为上层能够处理的格式。因此它主要负责数据格式的转换。
具体来说，就是将设备固有的数据格式转换为网络标准传输格式。不同设备 对同一比特流解释的结果可能会不同。因此，使它们保持一致是这一层的主要 作用。
- 会话层：负责建立和断开通信连接（数据流动的逻辑通路），以及数据的分割等数据 传输相关的管理。

------

- 传输层：起着可靠传输的作用。只在通信双方节点上进行处理，而元需在路由器上 处理。

- 网络层：将数据传输到目标地址。目标地址可以是多个网络通过路由器连接而成的某 一个地址。因此这一层主要负责寻址和路由选择。

------

- 数据链路层：负责物理层面上互连的、节点之间的通信传输。例如与 1 个以太网相连的 2 个节点之间的通信。 将0、 1 序列划分为具有意义的数据帧传送给对端（数据帧的生成与接收）。

- 物理层：负责0、 1 比特流（O 、 1 序列）与电压的高低、光的闪灭之间的互换。

------

### 1.2 **TCP/IP协议分层模型及每层常见协议**

**侧重在计算机上实现协议应该开发那种程序**

TCP/IP 协议族里重要的一点就是分层。TCP/IP 协议族按层次分别分为以下 4 层：应用层、传输层、网络层和数据链路层。

**应用层：**

通过应用进程间的交互来完成特定网络应用，定义了应用进程间通信和交互的规则。

TCP/IP 协议族内预存了各类通用的应用服务。对于不同的网络应用需要不同的应用层协议。在互联网中应用层协议很多，如**域名系统DNS**，支持万维网应用的 **HTTP协议**，支持电子邮件的 **SMTP协议**等等。我们把应用层交互的数据单元称为报文。

> 超文本传输协议（HTTP，HyperText Transfer Protocol)是互联网上应用最为广泛的一种网络协议。所有的 WWW（万维网） 文件都必须遵守这个标准。设计 HTTP 最初的目的是为了提供一种发布和接收 HTML 页面的方法。

**传输层：**

应用进程利用传输层传达应用层报文，**负责向两台主机进程之间的通信提供通用的数据传输服务**。多种应用可以使用同一个传输层服务，由于一台主机可以同时运行多个线程，传输层有分用和复用的功能。

复用：多个应用进程可以同时使用下面传输层的服务。

分用：运输层把收到的信息交付给上面应用层的相应进程。

在传输层有两个性质不同的协议：

TCP（Transmission Control Protocol，传输控制协议）提供**面向连接**的，**可靠的**数据传输服务。

UDP（User Data Protocol，用户数据报协议）提供**无连接**的，尽最大努力的数据传输服务（**不保证数据传输的可靠性**）。

**网络层（又名网络互连层）：**、

在计算机网络中进行通信的两个计算机之间可能会经过很多个数据链路，也可能还要经过很多通信子网。网络层的任务就是**选择合适的网间路由和交换结点，确保数据及时传送**。在发送数据时，**网络层把运输层产生的报文段或用户数据报封装成分组和包进行传送**。在 TCP/IP 体系结构中，由于网络层使用 **IP 协议**，因此分组也叫 **IP 数据报** ，简称 **数据报**。

互联网是由大量的异构（heterogeneous）网络通过路由器（router）相互连接起来的。互联网使用的网络层协议是**无连接的网际协议（Internet Protocol）和许多路由选择协议**，因此互联网的网络层也叫做**网际层**或**IP层**。

**IP 协议的作用是把各种数据包传送给对方**。而要保证确实传送到对方那里，则需要满足各类条件。其中两个重要的条件是 IP 地址和MAC 地址（Media Access Control Address）。

> IP 地址指明了节点被分配到的地址，MAC地址是指网卡所属的固定地址。
>
> IP 地址可以和MAC地址进行配对。IP 地址可变换，但MAC 地址基本上不会更改。

IP 间的通信依赖MAC地址。在网络上，通信的双方在同一局域网（LAN）内的情况是很少的，通常是经过多台计算机和网络设备中转才 能连接到对方。而在进行中转时，会利用下一站中转设备的MAC地址来搜索下一个中转目标。这时，会采用 **ARP 协议（Address Resolution Protocol）**。ARP 是一种用以解析地址的协议，根据通信方的 IP 地址就可以反查出对应的MAC地址。

**链路层（又名数字链路层、网络接口层）：**

**数据链路层(data link layer)通常简称为链路层。两台主机之间的数据传输，总是在一段一段的链路上传送的，这就需要使用专门的链路层的协议。** 在两个相邻节点之间传送数据时，**数据链路层将网络层交下来的 IP 数据报组装成帧**，在两个相邻节点间的链路上传送帧。每一帧包括数据和必要的控制信息（如同步信息，地址信息，差错控制等）。

在接收数据时，控制信息使接收端能够知道一个帧从哪个比特开始和到哪个比特结束。这样，数据链路层在收到一个帧后，就可从中提出数据部分，上交给网络层。 控制信息还使接收端能够检测到所收到的帧中有无差错。如果发现差错，数据链路层就简单地丢弃这个出了差错的帧，以避免继续在网络中传送下去白白浪费网络资源。如果需要改正数据在链路层传输时出现差错（这就是说，数据链路层不仅要检错，而且还要纠错），那么就要采用可靠性传输协议来纠正出现的差错。这种方法会使链路层的协议复杂些。

<img src="C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\image-20210329105434453.png" alt="image-20210329105434453" style="zoom:80%;" />

**物理层**

在物理层上所传送的数据单位是比特。

**物理层(physical layer)的作用是实现相邻计算机节点之间比特流的透明传送，尽可能屏蔽掉具体传输介质和物理设备的差异，** 使其上面的数据链路层不必考虑网络的具体传输介质是什么。“透明传送比特流”表示经实际电路传送后的比特流没有发生变化，对传送的比特流来说，这个电路好像是看不见的。

### 1.3 DNS解析过程，DNS基于哪种传输层协议

DNS（Domain Name System）域名解析服务，提供域名到IP地址之间的解析服务，位于应用层。

**DNS的传输层协议是UDP**

计算机既可以被赋予 IP 地址，也可以被赋予主机名和域名。用户通常使用主机名或域名来访问对方的计算机，而不是直接通过IP 地址访问。因为与 IP 地址的一组纯数字相比，用字母配合数字的表示形式来指定计算机名更符合人类的记忆习惯。

但要让计算机去理解名称，相对而言就变得困难了。因为计算机更 擅长处理一长串数字。 为了解决上述的问题，DNS 服务应运而生。

**DNS 协议提供通过域名查找 IP 地址，或逆向从 IP 地址反查域名的服务。**

> **根域：**根域服务器只是具有13个IP地址，但机器数量却不是13台，因为这些IP地址借助了[任播](https://zh.wikipedia.org/zh/任播)的技术，所以我们可以在全球设立这些IP的镜像站点，你访问到的这个IP并不是唯一的那台主机。
>
> **域的划分：**有两种划分方式，一种互联网刚兴起时的按照行业性质划分的com.，net.等，一种是按国家划分的如cn.，jp.，等。
>
> 每个域都会有域名服务器，也叫权威域名服务器。
>
> Baidu.com就是一个顶级域名，而www.baidu.com却不是顶级域名，他是在baidu.com 这个域里的一叫做www的主机。
>
> 一级域之后还有二级域，三级域，只要我买了一个顶级域，并且我搭建了自己BIND服务器（或者其他软件搭建的）注册到互联网中，那么我就可以随意在前面多加几个域了（当然长度是有限制的）。
>
> 比如a.www.baidu.com，在这个网址中，www.baidu.com变成了一个二级域而不是一台主机，主机名是a。
>
> **域名服务器：**能提供域名解析的服务器，上面的记录类型可以是A(address)记录，NS记录（name server），MX（mail），CNAME等。
>
> A记录是什么意思呢，就是记录一个IP地址和一个主机名字，比如我这个域名服务器所在的域test.baidu.com，我们知道这是一个二级的域名，然后我在里面有一条A记录,记录了主机为a的IP，查到了就返回给你了。
>
> 如果我现在要想baidu.com这个域名服务器查询a.test.baidu.com，那么这个顶级域名服务器就会发现你请求的这个网址在test.baidu.com这个域中，我这里记录了这个二级域的域名服务器test.baidu.com的NS的IP。我返回给你这个地址你再去查主机为a的主机把。
>
> **这些域内的域名服务器都称为权威服务器，直接提供DNS查询服务。**

- 本机向local dns请求www.baidu.com，如果自己缓存有的话直接返回，会被标记为非权威解答
- local dns向根域请求www.baidu.com，根域返回com.域的服务器IP
- 向com.域请求www.baidu.com，com.域返回baidu.com域的服务器IP
- 向baidu.com请求www.baidu.com，返回cname www.a.shifen.com和a.shifen.com域的服务器IP
- 向root域请求www.a.shifen.com
- 向com.域请求www.a.shifen.com
- 向shifen.com请求
- 向a.shifen.com域请求
- 拿到www.a.shifen.com的IP
- localdns返回本机www.baidu.com cname www.a.shifen.com 以及 www.a.shifen.com的IP

### 1.4 TCP三次握手、四次挥手的详细过程

**TCP报文首部**

<img src="C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\image-20210329180205253.png" alt="image-20210329180205253" style="zoom: 67%;" />

源端口和目的端口：各2个字节，分别写入源端口和目的端口

序列号seq：占4个字节，TCP连接中**传送的字节流中的每个字节**都按顺序编号

确认号ack：占4个字节，期望**收到对方下一个报文的第一个数据字节**的序号

数据偏移，占4位，它指出TCP报文的数据距离TCP报文段的起始处有多远

保留，占6位，保留今后使用，但目前应都位0

紧急URG，当URG=1，表明紧急指针字段有效。告诉系统此报文段中有紧急数据

**确认ACK，仅当ACK=1时，确认号字段才有效。**TCP规定，在连接建立后所有报文的传输都必须把ACK置1

推送PSH，当两个应用进程进行交互式通信时，有时在一端的应用进程希望在键入一个命令后立即就能收到对方的响应，这时候就将PSH=1

复位RST，当RST=1，表明TCP连接中出现严重差错，必须释放连接，然后再重新建立连接

**同步SYN，在连接建立时用来同步序号。当SYN=1，ACK=0**，表明是连接请求报文，若同意连接，则**响应报文中应该使SYN=1，ACK=1**

**终止FIN，用来释放连接。**当FIN=1，表明此报文的发送方的数据已经发送完毕，并且要求释放

窗口，占2字节，指的是通知接收方，发送本报文你需要有多大的空间来接受，这是接收方告诉发送方自己能够接受的缓冲区大小，这个值越大说明网络的吞吐量越大

检验和，占2字节，校验首部和数据这两部分

紧急指针，占2字节，指出本报文段中的紧急数据的字节数

选项，长度可变，定义一些其他的可选的参数

#### **三次握手的过程（建立TCP连接）**

![三次握手](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\aHR0cDovL2ltZy5ibG9nLmNzZG4ubmV0LzIwMTcwNjA1MTEwNDA1NjY2)

三次握手的目的是为了确认发送和接受方的通信时正常的。

> 开始的时候客户端和服务器都是处于CLOSED状态。主动打开连接的为客户端，被动打开连接的是服务器

- TCP**服务器进程先创建传输控制块TCB**，**时刻准备接受客户进程的连接请求**，此时服务器就进入了LISTEN（监听）状态

- TCP**客户进程也是先创建传输控制块TCB**，**然后向服务器发出连接请求报文**，这是报文首部中的同部位SYN=1，同时选择一个初始序列号 seq=x ，此时，**TCP客户端进程进入了 SYN-SENT**（同步已发送状态）状态。TCP规定，SYN报文段（SYN=1的报文段）不能携带数据，但需要消耗掉一个序号
- TCP**服务器收到请求报文后，如果同意连接，则发出确认报文**。确认报文中应该 ACK=1，SYN=1，确认号是ack=x+1，同时也要为自己初始化一个序列号 seq=y，此时，**TCP服务器进程进入了SYN-RCVD**（同步收到）状态。这个报文也不能携带数据，但是同样要消耗一个序号
- TCP**客户进程收到确认后，还要向服务器给出确认**。确认报文的ACK=1，ack=y+1，自己的序列号seq=x+1，此时，TCP连接建立，客户端进入ESTABLISHED（已建立连接）状态。TCP规定，ACK报文段可以携带数据，但是如果不携带数据则不消耗序号
- **当服务器收到客户端的确认后也进入ESTABLISHED状态，此后双方就可以开始通信了**

***为什么TCP客户端最后还要发送一次确认呢？（为什么是3次不是2次）***

防止已经失效的连接请求报文突然又传送到了服务器，从而产生了错误。如果是2次握手建立连接。

假设这样一种场景，客户端向服务端发送了一个请求连接并没有丢失，但是在网络中滞留时间很长，TCP的客户端迟迟没有收到确认的报文，以为服务端没有收到，就又重新发送一次请求连接，顺利到达服务器，两次握手成功来凝结，传输数据，关闭连接。若此时之前滞留的达到服务器，服务器握手，两次握手后再次建立连接，导致不必要的资源浪费。

采用三次握手，即便第二次握手成功，客户端也不会再次发出确认，服务器收不到确认，即知道了客户端并没有请求连接。

而三次即可建立有效连接，四次浪费资源

***第2次握手传回了ACK，为什么还要传回SYN？***

接收端传回发送端所发送的ACK是为了告诉客户端，我接收到的信息确实就是你所发送的信号了，这表明从客户端到服务端的通信是正常的。而**回传SYN则是为了建立并确认从服务端到客户端的通信**。

> SYN 同步序列编号(Synchronize Sequence Numbers) 是 TCP/IP 建立连接时使用的握手信号。在客户机和服务器之间建立正常的 TCP 网络连接时，客户机首先发出一个 SYN 消息，服务器使用 SYN-ACK 应答表示接收到了这个消息，最后客户机再以 ACK(Acknowledgement）消息响应。这样在客户机和服务器之间才能建立起可靠的 TCP 连接，数据才可以在客户机和服务器之间传递。

#### **四次挥手的过程（释放TCP连接）**

![四次挥手](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\aHR0cDovL2ltZy5ibG9nLmNzZG4ubmV0LzIwMTcwNjA2MDg0ODUxMjcy)

>  数据传输完毕后，双方都可释放连接。最开始的时候，客户端和服务器都是处于ESTABLISHED状态，**然后客户端主动关闭，服务器被动关闭**。

- **客户端进程发出连接释放报文，并且停止发送数据**。释放数据报文首部，FIN=1，其序列号为seq=u（等于前面已经传送过来的数据的最后一个字节的序号加1），此时，客户端进入FIN-WAIT-1（终止等待1）状态。 TCP规定，FIN报文段即使不携带数据，也要消耗一个序号。
- **服务器收到连接释放报文，发出确认报文**，ACK=1，ack=u+1，并且带上自己的序列号seq=v，此时，服务端就进入了CLOSE-WAIT（关闭等待）状态。TCP服务器通知高层的应用进程，客户端向服务器的方向就释放了，**这时候处于半关闭状态，即客户端已经没有数据要发送了，但是服务器若发送数据，客户端依然要接受**。这个状态还要持续一段时间，也就是整个CLOSE-WAIT状态持续的时间。
- **客户端收到服务器的确认请求后，此时，客户端就进入FIN-WAIT-2（终止等待2）状态，等待服务器发送连接释放报文**（在这**之前还需要接受服务器发送的最后的数据**）。
- **服务器将最后的数据发送完毕后，就向客户端发送连接释放报文，FIN=1，ack=u+1**，由于在半关闭状态，服务器很可能又发送了一些数据，假定此时的序列号为seq=w，此时，服务器就进入了LAST-ACK（最后确认）状态，等待客户端的确认。
- **客户端收到服务器的连接释放报文后，必须发出确认**，ACK=1，ack=w+1，而自己的序列号是seq=u+1，此时，**客户端就进入了TIME-WAIT（时间等待）状态**。注意此时TCP连接还没有释放，必须经过2 *MSL（最长报文段寿命）的时间后，当客户端撤销相应的TCB后，才进入CLOSED状态。
- **服务器只要收到了客户端发出的确认，立即进入CLOSED状态**。同样，撤销TCB后，就结束了这次的TCP连接。可以看到，**服务器结束TCP连接的时间要比客户端早一些。**

#### **为什么客户端最后还要等待2MSL？**

MSL（Maximum Segment Lifetime），TCP允许不同的实现可以设置不同的MSL值。

第一，**保证客户端发送的最后一个ACK报文能够到达服务器，因为这个ACK报文可能丢失**，站在服务器的角度看来，我已经发送了FIN+ACK报文请求断开了，客户端还没有给我回应，应该是我发送的请求断开报文它没有收到，于是服务器又会重新发送一次，而客户端就能在这个2MSL时间段内收到这个重传的报文，接着给出回应报文，并且会重启2MSL计时器。

第二，**防止类似与“三次握手”中提到了的“已经失效的连接请求报文段”出现在本连接中**。客户端发送完最后一个确认报文后，在这个2MSL时间中，就可以使本连接持续的时间内所产生的所有报文段都从网络中消失。从而保证在关闭连接后不会有还在网络中滞留的报文段去骚扰服务器。

#### **为什么建立连接是三次握手，关闭连接确是四次挥手呢？**

**建立连接的时候， 服务器在LISTEN状态下**，收到建立连接请求的SYN报文后，把ACK和SYN放在一个报文里发送给客户端。
**而关闭连接时，服务器收到对方的FIN报文时，仅仅表示对方不再发送数据了但是还能接收数据，而自己也未必全部数据都发送给对方了**，所以己方可以立即关闭，也可以发送一些数据给对方后，再发送FIN报文给对方来表示同意现在关闭连接，因此，己方ACK和FIN一般都会分开发送，从而导致多了一次。

#### **如果已经建立了连接，但是客户端突然出现故障了怎么办？**

TCP还设有一个**保活计时器**，显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。服务器**每收到一次客户端的请求后都会重新复位这个计时器，时间通常是设置为2小时**，若2小时还没有收到客户端的任何数据，服务器就会发送一个**探测报文段**，以后每隔75秒发送一次。若一连发送10个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。

### 1.5 UDP、TCP的区别、应用场景

**UDP：** 在传送数据之前不需要先建立连接，远地主机在收到 UDP 报文后，不需要给出任何确认， 不提供可靠交付。

应用场景：在某些情况下 UDP 确是一种最有效的工作方式（一般用于**即时通信**），如： QQ 语音、 QQ 视频 、直播等

**TCP ：**提供面向连接的服务。在传送数据之前必须先建立连接，数据传送结束后要释放连接。 TCP 不提供广播或多播服务。由于 TCP 要提供可靠的，面向连接的传输服务（TCP的可靠体现在TCP在传递数据之前，会有**三次握手来建立连接**，而且在数据传递时，有确认、窗口、重传、拥塞控制机制，在数据传完后，还会断开连接用来节约系统资源），这一难以避免增加了许多开销，如确认，流量控制，计时器以及连接管理等。这不仅使协议数据单元的首部增大很多，还要占用许多处理机资源。

应用场景：TCP 一般用于文件传输、发送和接收邮件、远程登录等场景。

### 1.6 什么是TIME_WAIT状态，为什么要有这个状态？

MSL（Maximum Segment Lifetime），TCP允许不同的实现可以设置不同的MSL值。

第一，**保证客户端发送的最后一个ACK报文能够到达服务器，因为这个ACK报文可能丢失**，站在服务器的角度看来，我已经发送了FIN+ACK报文请求断开了，客户端还没有给我回应，应该是我发送的请求断开报文它没有收到，于是服务器又会重新发送一次，而客户端就能在这个2MSL时间段内收到这个重传的报文，接着给出回应报文，并且会重启2MSL计时器。

第二，**防止类似与“三次握手”中提到了的“已经失效的连接请求报文段”出现在本连接中**。客户端发送完最后一个确认报文后，**在这个2MSL时间中，就可以使本连接持续的时间内所产生的所有报文段都从网络中消失**。这样新的连接中不会出现旧连接的请求报文。

### 1.7 TCP如何保证的可靠传输？

顺序控制、重发控制、流控制（流量控制）、拥塞控制、提高网络利用率

**检验和**

**序列号**：用来实现确认应答处理、重发控制、重复控制，能够判断是否已经接收数据以及判断是否需要接收

**确认应答**（ACK，也就是建立连接三次握手，断开连接四次握手）

**重发控制**（如果未收到ACK，那么就会进行数据重发）

​	有可能接收端已经收到，只不过ACK确认应答在中途丢失，这时候发送端会再发送一个数据，如果接收端接收到重复的数据会直接丢弃新发过来的；

​	也有可能只是数据包在网络中停留的时间久了一点，导致接收端还没有收到数据，如果每次都重新发送，那么接收端将不堪重负，需要提供一种重发控制和重复控制，这是通过序列号seq和确认应答号ack来实现的

**重发超时**：

​		无论网络拥堵情况发生何种变化，都需要提供高性能通信，因此每次发包前会计算往返的时间及其偏差，重发超时的时间比这个值略大一点，重发超时的最小时间是1，得是0.5的整数倍（unix以及windows系统超时以0.5s为单位进行控制），最初的数据包不知道往返时间，所以超时时间一般设为6s左右。

​		如果重发还是没有确认应答返回，那么就会不断地重发，每次等待应答时间*2，到达一定重发次数，就会判断网络或者对端主机发生了异常，强制关闭连接。	

**连接管理**

**窗口控制**：无需等待确认应答就可以发送多个数据，即使没有收到确认应答也可以被发送出去，确认应答即便丢失也无需重发

​		如果发送地某个报文段发生了丢失，如果主机连续三次收到了同一个确认应答，就会将其对应的数据重发，这种机制比之前地超时管理更加高效，被称为高速重发机制。

**流控制（流量控制）**：滑动窗口的大小是接收方将自己能够接受的缓冲区大小（也叫窗口2byte，16位）放入tcp报文段发送给发送端，这个值越大，网络的吞吐量越大，如果接收方的缓冲区面临数据溢出，窗口的值会随之减小，从而控制数据的发送量，实现TCP流控制。

**拥塞控制**：如果采用滑动窗口，在通信刚开始时发送大量数据可能会引起网络拥堵，TCP采用了一个慢启动的算法来解决此问题，对发送数据量进行控制。定义了一个拥塞窗口，每收到一次确认应答ACK就将其加一，然后于接收端主机通知的窗口比较去较小值，发送比这还要小的数据量。

### 1.8 HTTP有哪些方法，GET和POST的区别

**GET：获取资源 GET 方法用来请求访问已被 URI 识别的资源**。**指定的资源经服务器端解析后返回响应内容**。也就是说，如果请求的资源是文本，那就保持原样返回；如果是像 CGI（Common Gateway Interface，通用网关接 口）那样的程序，则返回经过执行后的输出结果。

**POST：用来传输实体的主体。** 虽然用 GET 方法也可以传输实体的主体，但一般不用 GET 方法进行传输，而是用 POST 方法。虽说 POST 的功能与 GET 很相似，但 POST 的主要目的并不是获取响应的主体内容。

**区别：**

一般get传参少，post传参多，但也不是硬性规定

**get是幂等的**，也就是说从服务端获取数据，每次获取的数据都是相同的，如果实现了delete方法的按钮用get请求方式，那么搜索引擎是不断在请求你的数据并执行删除操作，那客户端的数据就会不知不觉地被删除

**post是不幂等的**，向服务端提交数据，对服务端数据产生了影响，应该用post而不是get

**PUT：传输文件 PUT 方法用来传输文件。**

**HEAD：获得报文首部** HEAD方法和GET 方法一样，只是不返回报文主体部分。用于**确认 URI 的有效性及资源更新的日期时间**等。

**DELETE：删除文件 DELETE 方法用来删除文件**，是与 PUT 相反的方法。DELETE 方
法按请求 URI 删除指定的资源。

**OPTIONS：**询问支持的方法 OPTIONS 方法用来查询针对请求 URI 指定的资源支持的方法。

### 1.9 HTTPS连接过程

客户端向服务端发起连接请求，服务端向客户端发送数字证书，包含服务端公钥，客户端验证公钥，然后发送利用公钥加密的对称钥匙，服务端利用私钥解密，获取对称钥匙，两者之间的通信建立，两者通过对称的密钥进行通信。

### 1.10 浏览器中输入一个URL并回车会发生什么(显示主页的过程)

| 过程                                                         | 使用的协议                                                   |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 1、 浏览器查找域名的IP地址（DNS查找过程：浏览器缓存、路由器缓存、DNS缓存） | DNS：获取域名对应的IP、域名解析服务                          |
| 2、浏览器向web服务器发送HTTP请求（cookie会随请求发送给服务器） | HTTP：生成请求报文<br />TCP：与服务器建立TCP连接             |
| 3、服务器处理请求（请求 处理请求&参数、cookie、生成一个HTML相应） | IP：建立TCP协议时，需要发送数据，发送数据在网络层使用IP协议  |
| 4、服务器返回一个HTML响应并返回HTTP报文                      | OSPF（open shortest path first）：IP数据包在路由器之间，路由选择使用OSPF协议 |
| 5、浏览器解析渲染HTML页面并显示                              | ARP：路由器在服务器通信时，需要将IP地址转换为MAC地址，需要使用ARP协议 |
| 6、连接结束                                                  | HTTP：在TCP建立完成后，使用HTTP协议访问网页                  |

## 2. 高频，准备充分都应该对答如流

### 2.1 IP地址的分类 A/B/C/D类指的是什么？什么是子网掩码

**1、A类地址 1.0.0.0到126.255.255.255**
**只有第一段为网络号，剩下三段为主机号。用二进制表示则有8位即一个字节为网络号，24位即三个字节是主机号。**因此A类地址的网络地址较少，但是可以容纳的主机最多，数量为2的24次方减2等于16777214台主机，（减2是因为主机号全为1时表示该网络广播地址，全为0时表示该网络的网络号，这是两个特殊地址）等于网络地址的最高位必须是“0”，则用二进制表示地址范围是：00000001 00000000 00000000 00000000——01111110 11111111 11111111 11111111，即为1.0.0.0到126.255.255.255。子网掩码是255.0.0.0

（A与B类之间的网络地址为127.0.0.0到127.255.255.255。其中127.0.0.0为保留地址，127.0.0.1到127.255.255.254为特殊地址，其为本地的回环（loopback）地址,本地回环地址，不属于任何一个有类别地址类。它代表设备的本地虚拟接口，所以默认被看作是永远不会宕掉的接口。在windows操作系统中也有相似的定义，所以通常在不安装网卡前就可以ping通这个本地回环地址。一般都会用来检查本地网络协议、基本数据接口等是否正常的。本地回环地址主要作用有两个：一是测试本机的网络配置，能PING通127.0.0.1（通常都用127.0.0.1）说 明本机的网卡和IP协议安装都没有问题；另一个作用是某些SERVER/CLIENT的应用程序在运行时需调用服务器上的资源，一般要指定SERVER的 IP地址，但当该程序要在同一台机器上运行而没有别的SERVER时就可以把SERVER的资源装在本机，SERVER的IP地址设为127.0.0.1 同样也可以运行。）

127.255.255.255为广播地址

**2.B类地址 128.0.0.0到191.255.255.255**
**前两段为网络号，剩下两段为主机号。其可容纳主机为2的16次方减2等于65534台。**其地址的最高位必须是“10”.则二进制表示为：10000000 00000000 00000000 00000000——10111111 11111111 11111111 11111111，即为128.0.0.0到191.255.255.255。最后一个是广播地址。子网掩码是255.255.0.0。广播地址就是其主机号全部为1 时

 

**3、C类地址 192.0.0.0到223.255.255.255**
**前三段为网络号，剩下一段为主机号。可容纳主机为256-2=254台。C类地址的网络地址较多，适用于小规模的局域网。**其网络地址的最高位必须是“110”，二进制表示为：11000000 00000000 00000000 00000000——11011111 11111111 11111111 11111111,即为192.0.0.0到223.255.255.255。最后一个地址是广播地址。子网掩码是255.255.255.0

**4.D类地址  224.0.0.0到239.255.255.255**
**D类IP地址在历史上叫多播地址（multicast address),即组播地址。**在以太网中，多播地址命名了一组应该在这个网络应用中接
收到一个分组站点。多播地址的位最高必须是“1110”，二进制表示为：11100000 00000000 00000000 00000000 ——11101111 11111111 11111111 11111111，即为224.0.0.0到239.255.255.255

**5、子网掩码**

**子网掩码不能单独存在，是与IP地址结合在一起使用的。**

组成规则：**由0和1组成，掩码是通过二进制的与来掩码，掩的是主机的地址，而不改变网络的地址**。因此左边的网络号都为1，右边的主机号段都为0.则拿A类地址来说，它只有第一段为网络地址，则其子网掩码只有前八位是1，其余24位均为0，即：255.0.0.0。同理B类地址：255.255.0.0    C类地址:255.255.255.0

直接使用ABC类地址很浪费，所以可以使用子网掩码对ABC类地址进行进行细分，也就是将原来ABC类中的主机地址部分用作子网地址，将原来的网络分为多个物理网络的一种机制。

可以利用子网和IP地址按位求与，直接计算出网络地址。

CIDR（无类型域间选路）固定长度的子网掩码，将某一类的地址进行细分。

VLSM（可变长子网掩码）可以随机修改组织内各个部门的子网掩码长度，实现了高效的IP地址分配

CIDR和VLSM可以在一定程度上解决IP地址不够用，但IP地址绝对数没法改变

因此引入了一种可以互换全局IP地址和私有IP的NAT技术

此外还有IPV6

### 2.2 ARP协议的作用、简要原理

**ARP作用：**确定了IP地址，可以向这个目标地址发送IP数据包，在底层数据链路层，进行实际通信需要知道每个IP地址对应的mac地址。

ARP协议用来定位下一个应该接收数据分包的网路设备对应的MAC地址。

只适用于IPV4，IPV6用ICMPV6代替ARP发送邻居探索消息。

**简要原理：**主机A为了获得主机B的MAC地址，通过广播发送一个ARP请求包，包括想要了解其MAC地址的主机IP地址，会被同一链路上的所有主机或者路由器接收并解析，如果IP地址一致，那么这个节点就将自己的MAC地址塞入ARP响应并返回给请求主机A。

### 2.3 能不能两次/四次握手，为什么握手三次可以挥手却要四次

**握手：**两次握手的活，如果建立连接时，请求连接并没有丢失，服务端长时间没有返回确认报文，而客户端以为丢失就又发了一个连接然后成功建立连接服务器关闭，但第二个连接到达服务器，服务器又建立了一次连接，浪费资源，如果客户端在收到了来自服务器的确认报文再一次握手，就避免了这种情况发生。即便第二次握手成功，客户端也不会再次发出确认，服务器收不到确认，即知道了客户端并没有请求连接。

**挥手：**而关闭连接时，服务器收到对方的FIN报文时，仅仅表示对方不再发送数据了但是还能接收数据，而自己也未必全部数据都发送给对方了，所以己方可以立即关闭，也可以发送一些数据给对方后，再发送FIN报文给对方来表示同意现在关闭连接，因此，己方ACK和FIN一般都会分开发送，从而导致多了一次。

### 2.4 TCP快重传和快恢复，延迟确认应答、捎带应答

延迟确认应答：每收到两个数据段发送一次的确认应答

捎带应答：确认报文和回执数据一起发送

### 2.5 Cookie和Session区别

**Cookie 和 Session都是用来跟踪浏览器用户身份的会话方式**

**Cookie 一般用来保存用户信息**

① 我们在 Cookie 中保存已经登录过得用户信息，下次访问网站的时候页面可以自动帮你登录的一些基本信息给填了；

② 一般的网站都会有保持登录也就是说下次你再访问网站的时候就不需要重新登录了，这是因为用户登录的时候我们可以存放了一个 Token 在 Cookie 中，下次登录的时候只需要根据 Token 值来查找用户即可(为了安全考虑，重新登录一般要将 Token 重写)；

③ 登录一次网站后访问网站其他页面不需要重新登录。

**Session 的主要作用就是通过服务端记录用户的状态**

典型的场景是购物车，当你要添加商品到购物车的时候，系统不知道是哪个用户操作的，因为 HTTP 协议是无状态的。**服务端给特定的用户创建特定的 Session 之后就可以标识这个用户并且跟踪这个用户了**。

Cookie 数据保存在客户端(浏览器端)，Session 数据保存在服务器端。相对来说 Session 安全性更高。如果要在 Cookie 中存储一些敏感信息，不要直接写入 Cookie 中，最好能将 Cookie 信息加密然后使用到的时候再去服务器端解密。

###2.6 CSRF攻击和XSS攻击原理及防护

**CSRF：跨站请求伪造**（英语：Cross-site request forgery），也被称为 one-click attack 或者 session riding，通常缩写为 CSRF 或者 XSRF， 是一种挟制用户在当前已登录的Web应用程序上执行非本意的操作的攻击方法。

冒充用户发起请求（在用户不知情的情况下）,完成一些违背用户意愿的请求（如恶意发帖，删帖，改密码，发邮件等）。

**XSS：跨站脚本**（Cross-site scripting，通常简称为XSS）是一种网站应用程序的安全漏洞攻击，是代码注入的一种。它允许恶意用户将代码注入到网页上，其他用户在观看网页时就会受到影响。这类攻击通常包含了HTML以及用户端脚本语言。

通过客户端脚本语言（最常见如：JavaScript）在一个论坛发帖中发布一段恶意的JavaScript代码就是脚本注入，如果这个代码内容有请求外部服务器，那么就叫做XSS！

**防护措施：**一切外部来源数据，都要我们服务端代码的过滤，才能让他展示到页面上，也就是说，一切外部数据都是非法的，一定要做好过滤。

###2.7 HTTP请求报文和响应报文格式，请求行和响应行都有什么

**请求报文：**

1. 请求行
		请求方请求方式 请求url 请求协议/版本GET /login.html	HTTP/1.1
	
2. 请求头：客户端浏览器告诉服务器一些信息
  请求头名称: 请求头值

3. 请求空行
  空行，就是用于分割POST请求的请求头，和请求体的。

4. 请求体(正文)：

  封装POST请求消息的请求参数的

  ```properties
  POST /login.html	HTTP/1.1
  Host: localhost
  User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:60.0) Gecko/20100101 Firefox/60.0
  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
  Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
  Accept-Encoding: gzip, deflate
  Referer: http://localhost/login.html
  Connection: keep-alive
  Upgrade-Insecure-Requests: 1
  
  username=zhangsan	
  ```

**响应报文：**

1.响应行

​	协议版本 状态码及其描述 HTTP/1.1 200 OK

2.响应头

​	响应头用于描述服务器的基本信息，以及数据的描述

​	响应头：响应头值

3.响应体

​	响应体就是响应的消息体，如果是纯数据就是返回纯数据，如果请求的是HTML页面，那么返回的就是HTML代码，如果是JS就是JS代码

### 2.8 HTTP常见状态码及含义

![image-20210330102548506](C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\image-20210330102548506.png)

```
2xx （3种）
200 OK：表示从客户端发送给服务器的请求被正常处理并返回；
204 No Content：表示客户端发送给客户端的请求得到了成功处理，但在返回的响应报文中不含实体的主体部分（没有资源可以返回）；
206 Patial Content：表示客户端进行了范围请求，并且服务器成功执行了这部分的GET请求，响应报文中包含由Content-Range指定范围的实体内容。

3xx （5种）
301 Moved Permanently：永久性重定向，表示请求的资源被分配了新的URL，之后应使用更改的URL；
302 Found：临时性重定向，表示请求的资源被分配了新的URL，希望本次访问使用新的URL；
301与302的区别：前者是永久移动，后者是临时移动（之后可能还会更改URL）

303 See Other：表示请求的资源被分配了新的URL，应使用GET方法定向获取请求的资源；
302与303的区别：后者明确表示客户端应当采用GET方式获取资源
304 Not Modified：表示客户端发送附带条件（是指采用GET方法的请求报文中包含if-Match、If-Modified-Since、If-None-Match、If-Range、If-Unmodified-Since中任一首部）的请求时，服务器端允许访问资源，但是请求为满足条件的情况下返回改状态码；
307 Temporary Redirect：临时重定向，与303有着相同的含义，307会遵照浏览器标准不会从POST变成GET；（不同浏览器可能会出现不同的情况）；

4xx （4种）
400 Bad Request：表示请求报文中存在语法错误；
401 Unauthorized：未经许可，需要通过HTTP认证；
403 Forbidden：服务器拒绝该次访问（访问权限出现问题）
404 Not Found：表示服务器上无法找到请求的资源，除此之外，也可以在服务器拒绝请求但不想给拒绝原因时使用；

5xx （2种）
500 Inter Server Error：表示服务器在执行请求时发生了错误，也有可能是web应用存在的bug或某些临时的错误时；
503 Server Unavailable：表示服务器暂时处于超负载或正在进行停机维护，无法处理请求；
```



> 状态码和状况的不一致不少返回的状态码响应都是错误的，但是用户可能察觉不到这点。
>
> 比如Web应用程序内部发生错误，状态码依然返回 200 OK，这种情况也经常遇到。

### 2.9 HTTP长连接,短连接

**在HTTP/1.0中默认使用短连接。**也就是说，客户端和服务器每进行一次HTTP操作，就建立一次连接，任务结束就中断连接。当客户端浏览器访问的某个HTML或其他类型的Web页中包含有其他的Web资源（如JavaScript文件、图像文件、CSS文件等），每遇到这样一个Web资源，浏览器就会重新建立一个HTTP会话。

**而从HTTP/1.1起，默认使用长连接，用以保持连接特性。**使用长连接的HTTP协议，会在响应头加入这行代码：

```
Connection:keep-alive
```

在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的TCP连接不会关闭，客户端再次访问这个服务器时，会继续使用这一条已经建立的连接**。Keep-Alive不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。实现长连接需要客户端和服务端都支持长连接。**

**HTTP协议的长连接和短连接，实质上是TCP协议的长连接和短连接。**

### 2.10 HTTP是不保存状态的协议,如何保存用户状态?

HTTP 是一种不保存状态，即无状态（stateless）协议。也就是说 HTTP 协议自身不对请求和响应之间的通信状态进行保存。那么我们保存用户状态呢？**Session 机制的存在就是为了解决这个问题，Session 的主要作用就是通过服务端记录用户的状态**。典型的场景是购物车，当你要添加商品到购物车的时候，系统不知道是哪个用户操作的，因为 HTTP 协议是无状态的。服务端给特定的用户创建特定的 Session 之后就可以标识这个用户并且跟踪这个用户了（一般情况下，服务器会在一定时间内保存这个 Session，过了时间限制，就会销毁这个Session）。

**在服务端保存 Session 的方法很多，最常用的就是内存和数据库(比如是使用内存数据库redis保存)**。既然 Session 存放在服务器端，那么我们如何实现 Session 跟踪呢？大部分情况下，我们都是通过在 Cookie 中附加一个 Session ID 来方式来跟踪。

**Cookie 被禁用怎么办?**

最常用的就是利用 URL 重写把 Session ID 直接附加在URL路径的后面。

**应用场景**：购物车

### 2.11 HTTP与HTTPS的区别，HTTPS使用的是非对称加密还是对称加密？

1. **端口：** HTTP的URL由“http://”起始且默认使用端口80，而HTTPS的URL由“https://”起始且默认使用端口443。

2. **HTTP：**

   通信使用明文（不加密），内容可能会被窃听  ——>   通信的加密（SSL、TLS）、内容加密

   不验证通信方的身份，因此有可能遭遇伪装      ——>   查明对手的证书

   无法证明报文的完整性，所以有可能已遭篡改  ——>   MD5和 SHA-1 散列值校验，确认文件的数字签名方法

3. **HTTPS = HTTP + 加密处理 + 认证 + 完整性保护**

   HTTPS 是身披 SSL 外壳的 HTTP：

   HTTP 直接和 TCP 通信。当使用 SSL 时，则演变成先和SSL 通信，再由 SSL 和 TCP 通信了。简言之，所谓 HTTPS，其实就是身披 SSL 协议这层外壳的 HTTP。

> **对称密钥加密（共享密钥加密）**：加密和解密用同一个密钥，加密时必须将密钥发送给对方，可能被监听，有风险
>
> **非对称密钥加密（公开密钥加密）**：私钥任何人都不知道，公钥可以随意发布。发送密文一方用公钥加密，接收放用私钥进行解密，无需发送过来用于解密的私钥
>
> 非对称密钥加密处理速度要比对称密钥加密慢很多

​		HTTPS采用混合加密机制：

* 使用公开密钥加密方式安全地交换在稍后的共享密钥加密中要使用的密钥
* 确保交换的密钥是安全的前提下，使用共享密钥加密方式进行通信

​		证明公开密钥正确性的证书？

<img src="C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\image-20210330140154142.png" alt="image-20210330140154142" style="zoom: 67%;" />

<img src="C:\Users\94307\OneDrive - zju.edu.cn\learnbm\JAVA\学习笔记\image-20210330150751300.png" alt="image-20210330150751300" style="zoom: 67%;" />

### 2.11 HTTP1.0 / 1.1 / 2.0 / 3.0区别和特点

**HTTP 1.0**

短连接：每次发送请求都要重新建立tcp请求，即三次握手，非常浪费性能

无host头域，也就是http请求头里的host，

不允许断点续传，而且不能只传输对象的一部分，要求传输整个对象

**HTTP 1.1**

长连接，流水线，使用connection:keep-alive使用长连接，与http 2.0不同的是，

host头域

由于长连接会给服务器造成压力

**HTTP 2.0**

头部压缩，双方各自维护一个header的索引表，使得不需要直接发送值，通过发送key缩减头部大小

多路复用，使用多个stream，每个stream又分帧传输，使得一个tcp连接能够处理多个http请求

可以使用服务端推送 

**HTTP 3.0**

基于google的QUIC协议，而quic协议是使用udp实现的

减少了tcp三次握手时间，以及tls握手时间

解决了http 2.0中前一个stream丢包导致后一个stream被阻塞的问题

优化了重传策略，重传包和原包的编号不同，降低后续重传计算的消耗

连接迁移，不再用tcp四元组确定一个连接，而是用一个64位随机数来确定这个连接

更合适的流量控制

HTTP1.0最早在网页中使用是在1996年，那个时候只是使用一些较为简单的网页上和网络请求上，而HTTP1.1则在1999年才开始广泛应用于现在的各大浏览器网络请求中，同时HTTP1.1也是当前使用最为广泛的HTTP协议。 主要区别主要体现在：

1. **长连接** : **在HTTP/1.0中，默认使用的是短连接**，也就是说每次请求都要重新建立一次连接。HTTP 是基于TCP/IP协议的,每一次建立或者断开连接都需要三次握手四次挥手的开销，如果每次请求都要这样的话，开销会比较大。因此最好能维持一个长连接，可以用个长连接来发多个请求。**HTTP 1.1起，默认使用长连接** ,默认开启Connection： keep-alive。 **HTTP/1.1的持续连接有非流水线方式和流水线方式** 。流水线方式是客户在收到HTTP的响应报文之前就能接着发送新的请求报文。与之相对应的非流水线方式是客户在收到前一个响应后才能发送下一个请求。
2. **错误状态响应码** :在HTTP1.1中新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。
3. **缓存处理** :在HTTP1.0中主要使用header里的If-Modified-Since,Expires来做为缓存判断的标准，HTTP1.1则引入了更多的缓存控制策略例如Entity tag，If-Unmodified-Since, If-Match, If-None-Match等更多可供选择的缓存头来控制缓存策略。
4. **带宽优化及网络连接的使用** :HTTP1.0中，存在一些浪费带宽的现象，例如客户端只是需要某个对象的一部分，而服务器却将整个对象送过来了，并且不支持断点续传功能，HTTP1.1则在请求头引入了range头域，它允许只请求资源的某个部分，即返回码是206（Partial Content），这样就方便了开发者自由的选择以便于充分利用带宽和连接。

## 3. 一般，答出来能体现出知识的深度和广度，加分项

### 3.1 IPv4和IPv6的区别，IPv6的改进有哪些

IPV6 8个16位字节，总共128比特

1、IPv6使用更小的路由表。使得路由器转发数据包的速度更快。

2、IPv6增加了增强的组播支持以及对流的控制，对多媒体应用很有利，对服务质量（QoS）控制也很有利。

3、IPv6加入了对自动配置的支持。这是对DHCP协议的改进和扩展，使得网络（尤其是局域网）的管理更加方便和快捷。

4、IPv6具有更高的安全性。用户可以对网络层的数据进行加密并对IP报文进行校验，极大地增强了网络的安全性。

5、IPv6具有更好的扩容能力。如果新的技术或应用需要时，IPV6允许协议进行扩充。

6、IPv6具有更好的头部格式。IPV6使用新的头部格式，就简化和加速了路由选择过程，提高了效率

### 3.2 DNS的递归查询和迭代查询

### 3.3 DNS为什么使用UDP协议、DNS什么时候使用TCP协议

DNS服务器间进行区域传输的时候用TCP，其他的时候如客户端查询DNS服务器时用 UDP
dns有两个情况，一种是区域传输，一种是域名解析

1.区域传输时，一个区中主DNS服务器从自己本机的数据文件中读取该区的DNS数据信息，而辅助DNS服务器则从区的主DNS服务器中读取该区的DNS数据信息，传输协议是tcp。

2.域名解析时一般返回的内容都不超过512字节，首选的通讯协议是udp。使用udp传输，不用经过TCP三次握手，这样DNS服务器负载更低，响应更快

3.当域名解析的反馈报文的长度超过512字节时，将不能使用udp协议进行解析，此时必须使用tcp。通常传统的UDP报文一般不会大于512字节。
区域传输使用TCP协议的原因大概是：
1） 区域传输的数据量相比单次DNS查询的数据量要大得多
2） 区域传输对数据的可靠性和准确性相比普通的DNS查询要要高得多，因此使用TCP协议

### 3.4 域名劫持和域名投毒是什么

### 3.5 如何实现UDP的可靠传输

### 3.6 TCP和UDP的校验和如何计算

### 3.7 什么是SYN攻击

​		我们在TCP三次握手的讨论中已经看到，服务器为了响应一个收到的SYN,分配并初始化连接变量和缓存。然后服务器发送一个 SYNACK进行响应，并等待来自客户的ACK报文段。如果某客户不发送ACK来完成该三次握手的第三步，最终（通常在一分多钟之后）服务器将终止该半开连接并回收资源。

​		这种TCP连接管理协议为经典的DoS攻击即SYN洪泛攻击(SYN1 ood attack)提供了环境。在这种攻击中，攻击者发送大量的 TCP SYN报文段，而不完成第三次握手的步骤。随着这种SYN报文段纷至来，服务器不断为这些半开连接分配资源（但从未使用），导致服务器的连接资源被消耗殆尽这种SYN洪泛攻击是被记载的众多DoS攻击中的第一种。幸运的是，现在有一种有效的防御系统、称为 SYN cookie,它们被部署在大多数主流操作系统中。

 	SYN cookie特殊序列号

服务器生成一个初始TCP序列号，是SYN的源和目的IP地址与端口号以及只有该服务器知道的秘密数的一个散列函数，服务器发送具有这种特殊初始序列号的SYNACK分组。

如果服务端是合法的，那么将返回一个ACK报文段，服务端收到后需要验证是否与之前发送的SYN对应，对于一个合法的ACK，在确认字段中的值等于SYNACK的值加1，服务器将SYN的源和目的IP地址与端口号以及秘密数运行同一个散列函数，如果函数的结果加1与在客户的确认值相同的话，服务端则认为此请求是合法的。

### 3.8 TCP粘包是什么，有哪些原因

### 3.9 服务器存在大量TIME*WAIT或CLOSE*WAIT是因为什么，怎么解决

### 3.10 重定向和转发的区别

**forward（转发）**：

转发过程：客户浏览器发送http请求----》web服务器接受此请求--》调用内部的一个方法在容器内部完成请求处理和转发动作----》将目标资源发送给客户;在这里，转发的路径必须是同一个web容器下的url，其不能转向到其他的web路径上去，中间传递的是自己的容器内的request。在客户浏览器路径栏显示的仍然是其第一次访问的路径，也就是说客户是感觉不到服务器做了转发的。转发行为是浏览器只做了一次访问请求。

是服务器请求资源,服务器直接访问目标地址的URL,把那个URL的响应内容读取过来,然后把这些内容再发给浏览器.浏览器根本不知道服务器发送的内容从哪里来的,因为这个跳转过程实在服务器实现的，并不是在客户端实现的所以客户端并不知道这个跳转动作，所以它的地址栏还是原来的地址.

转发页面和转发到的页面可以共享request里面的数据.

一般用于用户登陆的时候,根据角色转发到相应的模块.

服务器内部转发，一般效率比较高

**redirect（重定向）**：状态码3xx（302）

重定向过程：客户浏览器发送http请求----》web服务器接受后发送302状态码响应及对应新的location给客户浏览器--》客户浏览器发现是302响应，则自动再发送一个新的http请求，请求url是新的location地址----》服务器根据此请求寻找资源并发送给客户。在这里 location可以重定向到任意URL，既然是浏览器重新发出了请求，则就没有什么request传递的概念了。在客户浏览器路径栏显示的是其重定向的路径，客户可以观察到地址的变化的。重定向行为是浏览器做了至少两次的访问请求的。

是服务端根据逻辑,发送一个状态码,告诉浏览器重新去请求那个地址.所以地址栏显示的是新的URL.

转发是服务器行为，重定向是客户端行为。

不能共享数据，因为转发的是两次请求，不是同一个request域

一般用于用户注销登陆时返回主页面和跳转到其它的网站等、

服务器外部重定向，一般效率比较低

### 3.11 URI和URL

- URI(Uniform Resource Identifier) 是统一资源标志符，可以唯一标识一个资源。
- URL(Uniform Resource Location) 是统一资源定位符，可以提供该资源的路径。它是一种具体的 URI，即 URL 可以用来标识一个资源，而且还指明了如何 locate 这个资源。

每个 URL 都是 URI，但不一定每个 URI 都是 URL。这是因为 URI 还包括一个子类，即统一资源名称 (URN)，它命名资源但不指定如何定位资源。

