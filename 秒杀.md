秒杀系统业务分析：设计了一个基于ssm框架的用于商品秒杀的系统

主要的操作

​	减库存+记录用户的购买明细-->完整事务-->数据落地

Mysql：开启事务——更新商品的库存信息——添加用户的购买明细——提交事务(若有同一个用户在秒杀，需要等待成功秒杀到商品的用户后MySQL成功提交了事务才能拿到这个商品的锁从而进行秒杀)

难点：高效处理竞争，高效完成事务	通过高并发来解决

实现功能：秒杀接口的暴露	执行秒杀的操作	相关查询(列表查询	详情页查询)

**持久层**编写dao接口和sql语句，代码和SQL的分离，便于Review，将编写sql代码的任务交给配置文件，可以实现解耦

**业务层**对dao层的方法进行拼接，实现秒杀成功时减库存，增加用户明细的功能，同时利用事务处理商品重复秒杀以及秒杀关闭等异常，失败:抛出异常，事务回滚

**web层**列表页+登录页（登陆过就不用登陆了，写入cookie）+详情页（秒杀倒计时+秒杀结束+秒杀成功）

针对高并发地优化：

- 商品详情页用户刷新，获取系统时间
- 地址暴露接口
- 执行秒杀操作
- MySQL执行的效率低，java和mysql通信延迟以及GC，事务很多sql阻塞，只能等另外的事务执行完才能够获得锁

优化方向：

后端缓存优化：

​	本来是通过秒杀逐渐访问数据库，改用redis，当用户进行秒杀时，会先到redis中寻找，没有的话才会去mysql数据库寻找，减少了数据库的访问压力

并发缓存优化：

可以先插入购买明细后减库存，降低行级锁的持有时间，是的mysql有更高的qbs，并且将事务流程在MySQL端完成，减少不必要的延时和GC

防止超卖？

前端加验证码，防止用户同时发出多个请求

sql语句要加数量的判断，数据库更新记录的时候会加锁，实际上是串行的执行update的，因此绝对不会卖超

防止少卖？

没有关系

​		